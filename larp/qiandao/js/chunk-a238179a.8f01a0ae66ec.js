(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a238179a"],{"0be7":function(e,t,a){},"2dc3":function(e,t,a){"use strict";a("0be7")},"95d4":function(e,t,a){"use strict";a("ca38")},ca38:function(e,t,a){},d33b:function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"speclist"},e._l(e.specData,(function(s,c){return t("div",{key:c,staticClass:"speclist-item"},[t("div",{staticClass:"name"},[e._v(" "+e._s(s.name)+" "),t("span",{staticClass:"name-hint"},[e._v("*")])]),t("div",{staticClass:"opts"},e._l(s.list,(function(c,i){return t("div",{key:i,class:"opts-item "+(e.currentSelectedSpecs.includes(c.value)&&"opts-item--actived"),on:{click:function(e){return a.handleClicItem(s,c)}}},[e._v(" "+e._s(c.label)+" ")])})),0)])})),0)},c=[],i=(a("d17e"),{__name:"SpecListStaticWidth",props:{specData:{type:Array,default:()=>[]},currentSelectedSpecs:{type:Array,default:()=>[]}},emits:["onClickSpecItem"],setup(e,{emit:t}){const a=(e,a)=>{t("onClickSpecItem",{itemData:e,singleData:a})};return{__sfc:!0,emits:t,handleClicItem:a}}}),n=i,l=(a("95d4"),a("0c7c")),r=Object(l["a"])(n,s,c,!1,null,"5f5a42c6",null);t["a"]=r.exports},d7fd:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"wrp"},[e._m(0),t("div",{staticClass:"content"},[e._m(1),t(a.SpecList,{attrs:{specData:a.specData,currentSelectedSpecs:a.currentSelectedSpecs},on:{onClickSpecItem:a.onClickSpecItem}}),t(a.CardList,{attrs:{mapData:a.spuMapList,imgsResultUrlList:a.aggregateImages,specData:a.specData,currentSelectedSpecs:a.currentSelectedSpecs},on:{onClickResultListItem:a.onClickResultListItem,onRemoveOneCard:a.onRemoveOneCard}}),a.remainingJobCount>0?t("div",{staticClass:"remaining-job"},[e._v(" 正在智能识别, 剩余任务("+e._s(a.remainingJobCount)+") ")]):e._e()],1),t("div",{staticClass:"actions"},[t(a.DuButton,{attrs:{full:"",size:"large"},on:{click:a.handlePublish}},[e._v("确认发布")])],1)])},c=[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"header"},[t("img",{attrs:{src:"https://cdn.qiandaoapp.com/interior/images/997f97ac6b6c3a565161a3d585f725be.png",alt:""}})])},function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"content-section"},[t("div",{staticClass:"content-section-title"},[e._v(" 批量设置 "),t("div",{staticClass:"content-section-title-tips"},[e._v(" 确定调整后会应用到所有商品 ")])])])}],i=(a("14d9"),a("2b0e")),n=a("39d4"),l=(a("809c"),a("886e")),r=a("d33b"),u=a("a382"),o=a("7cb2"),d=a("ed08"),p=a("dd8a"),v=a("ccbb"),m=(a("ccf4"),a("69a5")),g={__name:"index",setup(e){const{proxy:t}=Object(i["getCurrentInstance"])(),a=[{name:"来源",key:"from",list:[{label:"现货",value:"1"},{label:"非现货",value:"20774"}]},{name:"状态",key:"status",list:[{label:"全新",value:"139989"},{label:"默认初伤",value:"139990"},{label:"有伤",value:"139991"},{label:"已撕膜",value:"139992"},{label:"有原袋",value:"139993"},{label:"无原袋",value:"139994"}]}],s={currentPrice:void 0,currentCount:1,isShowRemark:!1,remark:""},c=Object(i["ref"])(["20773","139989"]),g=Object(i["ref"])(),f=Object(i["ref"])([]),b=Object(i["ref"])([]),h=Object(i["ref"])(["https://cdn.qiandaoapp.com/interior/images/215a953d55e59edfb9de9f4c0202bfe8.png","https://cdn.qiandaoapp.com/interior/images/215a953d55e59edfb9de9f4c0202bfe8.png"]),_=Object(i["ref"])([]),C=Object(i["ref"])(0),I=Object(i["computed"])(()=>f.value.length-C.value),S=({itemData:e,singleData:t})=>{const a=c.value;let s=-1,i="";e.list.forEach(e=>{a.includes(e.value)&&(i=e.value)}),i!==t.value&&(s=a.indexOf(i)),-1!==s?(a.splice(s,1),a.push(t.value)):a.push(t.value)},y=e=>{const t=_.value;let a=0;_.value.forEach((t,s)=>{t.index===e&&(a=s)}),t.splice(a,1),_.value=t},O=({singleData:e,itemIndex:t})=>{const a=_.value;let s=0;_.value.forEach((e,a)=>{e.index===t&&(s=a)}),a[s].currentActivedItem=e,_.value=a},k=async()=>{const e=await p["a"].fetchStep2BizConfig(),t=null===e||void 0===e?void 0:e.pluginsBizConfig[g.value];for(let a=0;a<h.value.length;a++)p["a"].searchSpuByAggregateImages({needCut:!0,scene:t.scene,url:h.value[a],typeIds:["1002893","1002894","1002895","1002896","1002897","1002898","1002899"]}).then(e=>{var t;const c=(null===(t=e.data)||void 0===t?void 0:t.results)||[];"0"===e.code&&c.length&&c.forEach((e,t)=>{const c=e.list||[];b.value.push(e.originImageUrl);const i=Object.assign(c[0],s),n=c.map(e=>Object.assign(e,s)),l=b.value.length-1;_.value.push({index:l,hitLogId:e.hitLogId,currentActivedItem:i,originFullImgUrl:h.value[a],splitImgUrl:e.originImageUrl,list:n.slice(0,20)})})}).finally(()=>{console.log("aggregateImages===",b.value),C.value++})},w=async()=>{const e=_.value.some(e=>!+e.currentActivedItem.currentPrice);if(!c.value.length)return void u["c"].show({icon:"none",title:"请选择面交时间"});if(e)return void u["c"].show({icon:"none",title:"有未填写价格的商品哦"});u["b"].show({title:"发布中"});const a=_.value.map(e=>({spuId:e.currentActivedItem.id,stock:e.currentActivedItem.currentCount,price:parseFloat((+e.currentActivedItem.currentPrice).toFixed(2)),remark:e.currentActivedItem.remark,status:"ON_SALE",specValueIds:c.value,attachments:[{type:"image",url:e.originFullImgUrl},{type:"image",url:e.splitImgUrl}]})),s=await v["a"].createProductMulti({args:a});if(await Object(m["b"])({productIds:s.data.productIds,scene:"multi_plugins"}),await Object(m["a"])(_),0===s.code){const e="/modules/pages-plugin/publisher?biz="+g.value;(Object(d["h"])()||Object(d["d"])())&&t.navigateTo({url:e})}else u["c"].show({icon:"none",title:"发布失败"});u["b"].hide()},j=()=>{t.navigateTo({url:"/modules/pages/web-view/index?url=https://mp.weixin.qq.com/s/rzJv9RYgpupvNOJ7e8cKsA"})},x=()=>{t.navigateTo({url:"/pages-me/users/product-on-sale?source=selling"})},L=()=>{t.navigateTo({url:"/pages-me/users/poster?"})};return Object(i["onMounted"])(async()=>{const{biz:e,filesKey:a}=t.$route.query;g.value=e;const s=await Object(o["c"])({key:a});h.value=s.data,k()}),{__sfc:!0,proxy:t,specData:a,defaultItemInfo:s,currentSelectedSpecs:c,localBiz:g,fileList:f,aggregateImages:b,imgsResultUrlList:h,spuMapList:_,spuMapCount:C,remainingJobCount:I,onClickSpecItem:S,onRemoveOneCard:y,onClickResultListItem:O,handleSearchSpuList:k,handlePublish:w,handleFollow:j,goToSelling:x,handlePoster:L,DuButton:n["a"],CardList:l["a"],SpecList:r["a"]}}},f=g,b=(a("2dc3"),a("0c7c")),h=Object(b["a"])(f,s,c,!1,null,"109f796b",null);t["default"]=h.exports}}]);