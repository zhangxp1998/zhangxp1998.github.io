(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cf783b0"],{"69a5":function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return c}));var r=s("f408"),i=s("ccf4");const a=({productIds:t,scene:e})=>new Promise(s=>{r["a"].reportClick("c2c_sell_success",{value:JSON.stringify({productIds:t,scene:e})}),setTimeout(()=>{s()},100)}),c=t=>new Promise(e=>{const s=t.value.map(t=>({hitLogId:t.hitLogId,hitResult:t.currentActivedItem.id,hitResultType:"SPU"}));i["a"].reportAnnotationData({items:s}).then(t=>{console.log("上报res",t)}),setTimeout(()=>{e()},100)})},"7cb2":function(t,e,s){"use strict";s.d(e,"b",(function(){return c})),s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return o}));var r=s("0ef7"),i=s("0d94"),a=s("a37c");async function c(t,e="interior-admin.image"){const s=Object(i["e"])({isProd:a["e"],async customApiCall(t){var e;const s=await r["h"].post("/uploader/gene-post-object-sign",t);return null===(e=s.data)||void 0===e?void 0:e[0]}});return s({file:t,scene:e})}function n(t){return r["h"].get("/uploader/file-space/get",t)}function o(t,e="interior-admin.image"){const s=Object(i["e"])({isProd:a["e"],async customApiCall(t){var e;const s=await r["h"].post("/uploader/anonymous/gene-post-object-sign",t);return null===(e=s.data)||void 0===e?void 0:e[0]}});return s({file:t,scene:e})}},"988b":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"price-ocr"},[t._m(0),e("div",{staticClass:"ocr-result-list"},[e("div",{staticStyle:{padding:"5px 15px 10px"}},[t._v(" 状态 "),e("div",{staticClass:"tags-wrap",staticStyle:{display:"inline-block"}},t._l([{id:9,value:"通行品相"},{id:10,value:"有瑕疵"},{id:11,value:" 评级卡"},{id:206,value:"有损伤"}],(function(s,r){return e("div",{key:r,class:["tag",{active:t.selectedZhuangtaiSpec===s.id}]},[e("div",{on:{click:function(e){t.selectedZhuangtaiSpec=s.id}}},[t._v(" "+t._s(s.value)+" ")])])})),0)]),e("div",{staticStyle:{padding:"0px 15px 15px"}},[t._v(" 来源 "),e("div",{staticClass:"tags-wrap",staticStyle:{display:"inline-block"}},t._l([{id:1,value:" 现货"},{id:61460,value:" 抽卡机直发"}],(function(s,r){return e("div",{key:r,class:["tag",{active:t.selectedLaiyuanSpec===s.id}]},[e("div",{on:{click:function(e){t.selectedLaiyuanSpec=s.id}}},[t._v(" "+t._s(s.value)+" ")])])})),0)]),t.loading&&!t.isPublishing?e("div",{staticClass:"loader"},[t._v(" 智能识别中…（"+t._s(this.ocrSuccessCount)+"/"+t._s(this.imageList.length)+"） ")]):t._e(),t.loading&&t.isPublishing?e("div",{staticClass:"loader"},[t._v(" 发布中...（剩余 "+t._s(this.ocrResultList.length-this.num)+"） ")]):t._e(),this.ocrResultList.length>0?e("div",{staticClass:"sku-list"},t._l(this.ocrResultList,(function(s,r){return e("div",{key:r,staticClass:"sku"},[e("div",{staticClass:"sku-cover-img"},[e("img",{attrs:{src:s.attachments[0].url+"!lfit_w1080.jpg",alt:"cover"}}),e("div",{staticClass:"delete-btn",on:{click:function(e){return t.deleteSku(r)}}},[e("img",{staticClass:"delete-btn-img",attrs:{src:"https://cdn.qiandaoapp.com/interior/images/dc293fba0d2bb97383dd834fb5226cbb.png",alt:"delete"}}),t._v(" 删除 ")])]),e("div",{staticClass:"info"},[e("div",{staticStyle:{color:"#a1a1a1"}},[t._v(t._s(s.category))]),e("div",{staticStyle:{"font-size":"16px"}},[t._v(" "+t._s(s.name)+" "),e("span",{staticStyle:{"font-size":"12px","margin-left":"5px"}},[t._v(" "+t._s(s.num)+" ")])]),e("div",[t._v(" 价格 "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.price,expression:"item.price"}],staticStyle:{width:"60px","margin-right":"5px"},attrs:{placeholder:"请输入"},domProps:{value:s.price},on:{input:function(e){e.target.composing||t.$set(s,"price",e.target.value)}}}),t._v(" 元 ")]),e("div",[t._v(" 描述 "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.description,expression:"item.description"}],attrs:{placeholder:"请输入"},domProps:{value:s.description},on:{input:function(e){e.target.composing||t.$set(s,"description",e.target.value)}}})]),e("div",{staticClass:"info-price"},[t._v(" "+t._s(t.getPriceText(s))+" ")])])])})),0):t._e(),e("div",{class:["fixed-btn",{disable:this.loading&&this.ocrResultList.length>0}],on:{click:t.publish}},[t.isPublishing?[t._v("发布中..")]:[t._v("下一步")]],2)])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("div",{staticStyle:{"font-size":"24px","margin-bottom":"10px"}},[t._v("小马宝莉闲置发布")]),e("div",{staticClass:"step"},[e("div",{staticClass:"circle"},[t._v("1")]),t._v(" 上传图片 ")]),e("div",{staticClass:"step active"},[e("div",{staticClass:"circle"},[t._v("2")]),t._v(" 预览结果 ")]),e("div",{staticClass:"step"},[e("div",{staticClass:"circle"},[t._v("3")]),t._v(" 一键发布 ")])])}],a=(s("14d9"),s("7cb2")),c=s("ed08"),n=s("2f62"),o=s("dd8a"),u=s("a849"),l=s("ccbb"),p=s("69a5"),g={data(){return{loading:!0,imageList:[],ocrResultList:[],ocrSuccessCount:0,isOpenModal:!1,selectedIndex:0,spuList:[],query:"",image:"",num:0,isPublishing:!1,selectedZhuangtaiSpec:9,selectedLaiyuanSpec:1,biz:""}},computed:{...Object(n["mapState"])("user",["me"]),isWxMp(){return Object(c["h"])()},isApp(){return Object(c["d"])()}},async mounted(){var t;"{}"===JSON.stringify(this.me)&&this.logIn();const e=null===(t=this.$route)||void 0===t?void 0:t.query;if(e.filesKey)try{const t=await Object(a["c"])({key:e.filesKey});this.imageList=t.data,this.ocr()}catch(s){console.error(s)}e.biz&&(this.biz=e.biz)},methods:{getPriceText(t){let e="";return t&&(this.isEdit?(null!==t&&void 0!==t&&t.minPrice&&(e=`闲置最低 ${t.minPrice} 元`),t.minPrice&&t.c2cAvgPrice&&(e+="，"),t.c2cAvgPrice&&(e+=`成交均价 ${t.c2cAvgPrice} 元`),(t.minPrice||t.c2cAvgPrice)&&t.stockOrderAvgPrice&&(e+=";"),t.stockOrderAvgPrice&&(e+=`闪购均价 ${t.stockOrderAvgPrice} 元`)):(null!==t&&void 0!==t&&t.minPrice&&(e=`玩家在卖 ${t.minPrice} 元起`),t.minPrice&&t.strikePrice&&(e+="，"),t.strikePrice&&(e+=`成交均价 ${t.strikePrice?Number(t.strikePrice).toFixed(1):t.strikePrice} 元`))),e},deleteSku(t){this.ocrResultList.splice(t,1),this.$toast.show({title:"已删除"})},async ocr(){this.ocrResultList=[],this.ocrSuccessCount=0;for(var t=0;t<this.imageList.length;t++){this.loading=!0;try{const a=await o["a"].ocr({url:this.imageList[t]+"!lfit_w1080.jpg",ocrType:"ALIYUN",level:"HD"});var e=a.data.prismWordsInfo;const c=await o["a"].ocr({url:this.imageList[t]+"!rotate_270",ocrType:"ALIYUN",level:"HD"});e=e.concat(c.data.prismWordsInfo);for(var s=!1,r=0;r<e.length;r++)if(-1!==e[r].word.indexOf("-")){const a={q:e[r].word,"start-index":0,"max-results":1,tagIds:"1422849",scene:"plugin-mlp-publish"};try{const e=await l["a"].searchSpuInTag(a);e.data.items.length>0&&!s&&(this.ocrResultList.push({attachments:[{url:this.imageList[t],type:"image"}],spuId:e.data.items[0].id,price:null,category:e.data.items[0].category_name,name:e.data.items[0].name,num:e.data.items[0].description,minPrice:e.data.items[0].min_price,strikePrice:e.data.items[0].strikePrice,description:""}),s=!0)}catch(i){console.error(i)}}this.ocrSuccessCount++}catch(i){console.error(i)}}0===this.ocrResultList.length&&(this.part=1,this.$toast.show({title:"未识别到款式"})),this.loading=!1},handleMaskClick(){this.isOpenModal=!1,this.query=""},logIn(){const t="/modules/pages/common-login/index";Object(c["h"])()||Object(c["d"])()?this.navigateTo({url:t}):window.location.href="https://m.qiandaoapp.com/assist/#/login?redirectUrl=https%3A%2F%2Fm.qiandaoapp.com%2Fplugin%2Fmlp-publish"},async publish(){this.isPublishing=!0,this.part=3,this.loading=!0,this.num=0;for(var t=0;t<this.ocrResultList.length;t++){this.num++;const e={attachments:this.ocrResultList[t].attachments,price:Number(this.ocrResultList[t].price),remark:this.ocrResultList[t].description,specValueIds:[this.selectedZhuangtaiSpec,this.selectedLaiyuanSpec],spuId:this.ocrResultList[t].spuId,status:"ON_SALE",stock:1,type_id:1405184};try{const t=await u["a"].productPublish(e);await Object(p["b"])({productIds:[t.id],scene:"multi_plugins"})}catch(s){console.error(s),this.ocrResultList.splice(t-1,t),this.part=2}}this.isPublishing=!1,this.loading=!1;const e="/modules/pages-plugin/publisher?biz="+this.biz;(Object(c["h"])()||Object(c["d"])())&&this.navigateTo({url:e})}}},d=g,h=(s("d052"),s("0c7c")),v=Object(h["a"])(d,r,i,!1,null,null,null);e["default"]=v.exports},a849:function(t,e,s){"use strict";var r=s("0ef7"),i=s("4360");e["a"]={getSingleBanner(t){return r["p"].get("/ads",{slotKey:t,appid:i["a"].state.app.puppet.name})},queryDeliverOrderPrice(t){return r["h"].post("/order/action/query-deliver-order-price",t)},getSellingProducts(t){return r["h"].get("trade/user/products/action/get-selling-products",t)},doGrayscale(t){return r["h"].get("/stock-order/grayscale",t)},queryShelfExpressRule(t){return r["h"].post("/express/user/express-price-template/action/load-by-shelf",t)},queryProductsMatch(t){return r["p"].get("/products/match",t)},queryProductsByTag(t){return r["h"].post("/stock-order/bargin",t)},productPublish(t){return r["h"].post("/trade/products",t)},getAuctionField(t){return r["h"].get("/auctioneer/field/list",t)},auctionPublish(t){return r["h"].post("/c2c-web/v1/auctioneer/auction/create",t)},getTags(t){return r["h"].get("/trade/tags",t)}}},ccbb:function(t,e,s){"use strict";var r=s("0ef7");e["a"]={getStandardProducts(t){return r["p"].get(`/spus/${t}/standard-products`)},getSPUs(t){return r["p"].get("/v2/spus",t)},getSingleSpu(t,e){return r["p"].get("/v2/spus/"+t,e)},getUserPosters(t){return r["h"].post("/c2c-web/v1/poster/get-user-posters",t)},doProductsOffSale(t){return r["h"].post("/c2c-web/v1/c2c/products/off-sale",t)},plastSearchCategory(t){return r["h"].get("/plast/search/category/v3",t)},createUserPoster(t){return r["h"].post("/c2c-web/v1/poster/create-user-poster",t)},getSPUSpecs(t){return r["p"].get(`/spus/${t}/specs`)},updateC2cProductsByCategory(t){return r["h"].post("/c2c/products/m-update",t)},updateProductMulti(t){return r["h"].post("/c2c/products/multi-create",t)},createProductMulti(t){return r["h"].post("/c2c/products/m-create-update",t)},getProductsByCategory(t){return r["h"].get("/c2c/products/by-category",t)},getCategoryDetail(t,e){return r["p"].get("/v2/categories/"+t,e)},getCategories(t){return r["p"].get("/v2/categories",t)},getRecommendCategories(t){return r["p"].get(`/v2/categories/${t}/recommend`)},getCategoryTags(t){return r["p"].get(`/v2/categories/${t}/config`)},getTag(t,e){return r["p"].get("/tags/"+t,e)},getHotTags(t){return r["p"].get(`/tags/${t}/config`)},getTags(t){return r["p"].get("/tags",t)},searchCategories(t){return r["p"].get("/v2/categories",t)},getSettings(){return r["p"].get("/settings")},changeWishes(t){return r["p"].post("/wish-list",t)},updateUserSettings(t){return r["p"].put("/settings",t)},getPosterColumnConfig(t){return r["l"].get("/action/get-products-poster",t)},getPosterThemes(t){return r["l"].get("/action/get-poster-themes",t,{isErrorDefaultTip:!1})},getWishList(t){return r["p"].get("/wish-list",t,{isErrorDefaultTip:!1})},getWishMatches(t){return r["p"].get("/products/match/wish-list",t,{isErrorDefaultTip:!1})},getDemandProductList(t){return r["p"].get("/products/match/demand-list",t)},getTradeInfo(t){return r["p"].post("/action/get-trade-info",t)},get360DegImages(t){return r["p"].get(`/spus/${t}/360-degree-images`)},getBarginSpus(t){return r["p"].post("/stock-order/bargin",t)},getSpecsByMPName(t){return r["p"].get("/specs/aciton/get-by-app-name",t)},getDistribution(t){return r["p"].get("/feeds/chaowan",t)},getSellingCategories(t){return r["p"].get("/products/action/get-selling-categories",t)},getCategoryCount(t){return r["p"].get("/products/action/get-category-product-count",t)},getSpuList(t){return r["h"].post("/treasure/spus/search/simple-info",t)},getSpuHeader(t){return r["h"].get("/treasure/flora/v2/spu/simpleInfo",t)},getSpuDetails(t){return r["h"].get("/treasure/flora/v1/spu/detailInfo",t)},getTagList(t){return r["h"].get("/treasure/tags",t)},getTagDetails(t){return r["h"].get("/treasure/flora/v1/tag/detailInfo",t)},getTagDetailsV2(t){return r["h"].get("/treasure/flora/v2/tag/simpleInfo",t)},searchSpuInTag(t){return r["h"].get("/plast/search/spu",t)},searchTag(t){return r["h"].get("/plast/search/tag",t)},getXiaokaWebConfig(){return r["e"].get("/vinyl/web.json")},getTagsV2(t){return r["h"].get("/armory/entry/tags",t)}}},ccf4:function(t,e,s){"use strict";var r=s("0ef7");e["a"]={reportAnnotationData(t){return r["m"].post("/user/ir/action/feedback-hit-result",t)}}},d052:function(t,e,s){"use strict";s("d25b")},d25b:function(t,e,s){},dd8a:function(t,e,s){"use strict";var r=s("0ef7");e["a"]={myPokemon(t){return r["q"].get("/v1/pokemon/my",t)},nextStep(t){return r["q"].post("/v1/pokemon/next-step",t)},searchSpuByImage(t){return r["q"].post("/v1/image/search/spu",t)},searchSpuByAggregateImages(t){return r["q"].post("/v1/image/search/multi/spu/v2",t)},ocr(t){return r["j"].post("/z/stargazing/z/ocr",t)},getQrcode(t){return r["j"].get("/z/poster-web/wechat/mp-qrcode",t)},getSpuOpposite(t){return r["j"].post("/treasure/spus/opposite/list",t)},getSpuWithRelated(t){return r["j"].post("/treasure/v1/search/spu/with/related",t)},getSpuWaterfall(t){return r["j"].get("/treasure/v1/waterfall/list",t)},fetchStep2BizConfig(){return r["j"].get("https://config-cdn.qiandaoapp.com/mp-common/pluginsBizConfig.json")},getRankInfo(t){return r["j"].get("/treasure/flora/v1/rank",t)},getByDistributedTagIds(t){return r["j"].post("/treasure/v1/public-relations/byDistributedTagIds",t)},getPalworld(t){return r["g"].get("/palu/check",t)}}}}]);