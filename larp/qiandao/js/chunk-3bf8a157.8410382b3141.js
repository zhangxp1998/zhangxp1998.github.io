(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bf8a157"],{"334c":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bgg-rank"},[e("div",{staticClass:"tabs"},[e("div",{class:["tab",{active:"高分榜"===t.selectedTab}],on:{click:function(e){t.selectedTab="高分榜"}}},[t._v(" 高分榜 ")]),e("div",{class:["tab",{active:"热榜"===t.selectedTab}],on:{click:function(e){t.selectedTab="热榜"}}},[t._v(" 热榜 ")])]),"高分榜"===t.selectedTab?[e("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"searchbox",attrs:{placeholder:"请输入名称搜索"},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}}),e("ul",[t._m(0),t.loading?e("div",{staticClass:"loader"},[t._v("加载中..")]):t._e(),t._l(this.bggRank,(function(s,a){return[!t.query||s.spuName&&s.spuName.indexOf(t.query)>-1||s.name.indexOf(t.query)>-1?e("li",{key:a,on:{click:function(e){return t.jump(a)}}},[e("span",{staticClass:"mini",staticStyle:{"font-style":"italic"}},[t._v(t._s(s.rank))]),e("img",{attrs:{src:s.coverUrl}}),e("div",{staticClass:"name"},[s.spuId?[t._v(" "+t._s(s.spuName)+" "),e("div",{staticClass:"intro"},[t._v(" "+t._s(s.name)+" "),e("span",{staticClass:"intro"},[t._v(t._s(s.year))])])]:[t._v(" "+t._s(s.name)+" "),e("span",{staticClass:"intro"},[t._v(t._s(s.year))])]],2),e("span",{staticClass:"short"},[t._v(t._s(s.geekRating))]),e("span",{staticClass:"short"},[t._v(t._s(s.AvgRating))]),e("span",{staticClass:"short"},[t._v(t._s(s.NumVoters))])]):t._e()]}))],2)]:t._e(),"热榜"===t.selectedTab?[e("input",{directives:[{name:"model",rawName:"v-model",value:t.hotQuery,expression:"hotQuery"}],staticClass:"searchbox",attrs:{placeholder:"请输入名称搜索"},domProps:{value:t.hotQuery},on:{input:function(e){e.target.composing||(t.hotQuery=e.target.value)}}}),e("ul",[t._m(1),t.loading?e("div",{staticClass:"loader"},[t._v("加载中..")]):t._e(),t._l(this.bggHotRank,(function(s,a){return[!t.hotQuery||s.spuName&&s.spuName.indexOf(t.hotQuery)>-1||s.name.indexOf(t.hotQuery)>-1?e("li",{key:a,staticStyle:{position:"relative"},on:{click:function(e){return t.jump(a)}}},[e("div",{staticStyle:{position:"absolute",right:"10px",top:"20px","font-size":"12px"}},[s.delta>0?e("span",{staticStyle:{color:"#ae141e"}},[t._v(" "+t._s(s.delta)+" ▲ ")]):t._e(),s.delta<0?e("span",{staticStyle:{color:"#1e8650"}},[t._v(" "+t._s(s.delta)+" ▼ ")]):t._e()]),e("span",{staticClass:"mini",staticStyle:{"font-style":"italic"}},[t._v(" "+t._s(a+1)+" "),e("div")]),s.images&&s.images.square100&&s.images.square100.src?e("img",{attrs:{src:s.images.square100.src}}):t._e(),e("div",{staticClass:"name",staticStyle:{width:"calc(100% - 108px)"}},[s.spuId?[t._v(" "+t._s(s.spuName)+" "),e("div",{staticClass:"intro"},[t._v(" "+t._s(s.name)+" "),e("span",{staticClass:"intro"},[t._v(t._s(s.yearpublished))])])]:[t._v(" "+t._s(s.name)+" "),e("span",{staticClass:"intro"},[t._v(t._s(s.yearpublished))])]],2)]):t._e()]}))],2)]:t._e()],2)},r=[function(){var t=this,e=t._self._c;return e("li",{staticStyle:{"font-size":"12px","font-weight":"bold"}},[e("span",{staticClass:"mini"},[t._v("排名")]),e("span",{staticClass:"short",staticStyle:{"margin-right":"10px"}}),e("div",{staticClass:"name"},[t._v("名称")]),e("span",{staticClass:"short"},[t._v("极客评分")]),e("span",{staticClass:"short"},[t._v("平均分")]),e("span",{staticClass:"short"},[t._v("评分人数")])])},function(){var t=this,e=t._self._c;return e("li",{staticStyle:{"font-size":"12px","font-weight":"bold",padding:"5px 40px 5px 0"}},[e("span",{staticClass:"mini"},[t._v("排名")]),e("span",{staticClass:"short",staticStyle:{"margin-right":"10px"}}),e("div",{staticClass:"name"},[t._v("名称")])])}],i=s("ed08"),n=s("f61f"),o=s("684b"),c=(s("bc3a"),{data(){return{loading:!1,bggRank:[],query:"",ids:[],bggHotRank:[],hotQuery:"",selectedTab:"高分榜"}},async created(){const t=await Object(n["a"])("bgg-rank","default");this.ids=t.ids,this.getRank(1),setTimeout(()=>{this.getRank(2)},500),setTimeout(()=>{this.getRank(3)},1e3),this.getHotRank()},methods:{async getRank(t){this.loading=!0;try{const e=await o["a"].gstoneGames({url:"boardgamegeek.com/browse/boardgame/page/"+t+"?sort=rank&sortdir=asc",method:"GET"}),s=new DOMParser,a=s.parseFromString(e,"text/html"),r=a.querySelectorAll("tr#row_"),i=Array.from(r).map(t=>{const e={},s=t.querySelectorAll("a.primary")[0].href.match(/boardgame\/\d+/),a=s[0].replace(/boardgame\//,"");return e.bggId=a,e.rank=t.querySelectorAll("td.collection_rank")[0].innerText.replace(/\D/g,""),e.coverUrl=t.querySelectorAll("img")[0].src,e.name=t.querySelectorAll("a.primary")[0].innerText,e.year=t.querySelectorAll("span.smallerfont")[0].innerText,e.geekRating=t.querySelectorAll("td.collection_bggrating")[0].innerText.replace(/\n/g,"").replace(/\t/g,""),e.AvgRating=t.querySelectorAll("td.collection_bggrating")[1].innerText.replace(/\n/g,"").replace(/\t/g,""),e.NumVoters=t.querySelectorAll("td.collection_bggrating")[2].innerText.replace(/\D/g,""),this.ids.filter(t=>t.bggId.toString()===a).length>0&&(e.spuId=this.ids.filter(t=>t.bggId.toString()===a)[0].spuId,e.spuName=this.ids.filter(t=>t.bggId.toString()===a)[0].name),e});this.bggRank=this.bggRank.concat(i),this.bggRank=this.bggRank.sort((t,e)=>t.rank-e.rank)}catch(e){console.error("Error loading or parsing HTML:",e)}this.loading=!1},async getHotRank(){this.loading=!0;try{const e=await o["a"].gstoneGames({url:"api.geekdo.com/api/hotness?geeksite=boardgame&objecttype=thing&showcount=50",method:"GET"});this.bggHotRank=e.items;for(var t=0;t<this.bggHotRank.length;t++)this.ids.filter(e=>e.bggId.toString()===this.bggHotRank[t].objectid).length>0&&(this.bggHotRank[t].spuId=this.ids.filter(e=>e.bggId.toString()===this.bggHotRank[t].objectid)[0].spuId,this.bggHotRank[t].spuName=this.ids.filter(e=>e.bggId.toString()===this.bggHotRank[t].objectid)[0].name)}catch(e){console.error("Error loading or parsing HTML:",e)}this.loading=!1},jump(t){var e="";"高分榜"===this.selectedTab&&this.bggRank[t].spuId?e="/pages-market/spu/index?spuId="+this.bggRank[t].spuId:"热榜"===this.selectedTab&&this.bggHotRank[t].spuId&&(e="/pages-market/spu/index?spuId="+this.bggHotRank[t].spuId),e&&(console.log(e),(Object(i["h"])()||Object(i["d"])())&&this.navigateTo({url:e}))}}}),l=c,g=(s("4c09"),s("0c7c")),u=Object(g["a"])(l,a,r,!1,null,null,null);e["default"]=u.exports},"4c09":function(t,e,s){"use strict";s("a8ef")},"684b":function(t,e,s){"use strict";var a=s("0ef7");e["a"]={getPostAnalysis(t){return a["d"].get("/analysis/"+t)},createPostReviewV3(t){return a["h"].post("/gactus/post-review-v3",t)},updatePostReviewV3(t){return a["h"].put("/gactus/post-review-v3",t)},deleteSpuMark(t){return a["h"].post("/gactus/delete-spu-mark",t)},createPostArticle(t){return a["h"].post("/gactus/posts-article",t)},getPostListByTopic(t){return a["h"].post("/gactus/topics/posts-v3",t)},getPostListByTag(t){return a["h"].post("/gactus/posts/by-tag-v4",t)},mark(t){return a["h"].post("/gactus-web/v1/mark/edit",t)},createPost(t){return a["h"].post("/gactus-web/post/create",t)},createPostStandard(t){return a["h"].post("/gactus-web/post/standard/create",t)},updatePostStandard(t){return a["h"].post("/gactus-web/post/standard/update",t)},comment(t){return a["h"].post("/cactus-api/comments",t)},getUserHobbyMark(t){return a["h"].post("/gactus/user-hobby-mark",t)},getUserMark(t){return a["h"].post("/gactus-web/v1/get-user-marks",t)},getUserHobbyList(t){return a["h"].get("/gactus-web/v1/interest/list",{uid:t})},gstoneGames(t){return a["h"].post("/config-go/redirect/gstoneGames",t)}}},a8ef:function(t,e,s){}}]);