(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4955c51f"],{"5f77":function(t,e,s){},"7cb2":function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return c})),s.d(e,"a",(function(){return o}));var i=s("0ef7"),r=s("0d94"),a=s("a37c");async function n(t,e="interior-admin.image"){const s=Object(r["e"])({isProd:a["e"],async customApiCall(t){var e;const s=await i["h"].post("/uploader/gene-post-object-sign",t);return null===(e=s.data)||void 0===e?void 0:e[0]}});return s({file:t,scene:e})}function c(t){return i["h"].get("/uploader/file-space/get",t)}function o(t,e="interior-admin.image"){const s=Object(r["e"])({isProd:a["e"],async customApiCall(t){var e;const s=await i["h"].post("/uploader/anonymous/gene-post-object-sign",t);return null===(e=s.data)||void 0===e?void 0:e[0]}});return s({file:t,scene:e})}},"88d8":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"price-ocr"},[e("div",{staticClass:"header"},[e("div",{staticStyle:{"font-size":"24px","margin-bottom":"10px"}},[t._v("小马宝莉闲置发布")]),t._l(["上传图片","预览结果","一键发布"],(function(s,i){return e("div",{key:i,class:["step",{active:i===t.part-1}]},[e("div",{staticClass:"circle"},[t._v(t._s(i+1))]),t._v(" "+t._s(s)+" ")])}))],2),1===this.part?e("div",{staticClass:"screenshot-list"},[e("div",{staticClass:"image-list"},[t._m(0),t._l(this.imageList,(function(s,i){return e("div",{key:i,staticClass:"screenshot"},[e("img",{staticClass:"screenshot-img",attrs:{src:s,alt:"screenshot"}}),e("div",{staticClass:"delete-btn",on:{click:function(e){return t.deleteImage(i)}}},[t._v("×")])])})),t._m(1),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"upload",accept:"image/png, image/jpeg",multiple:"multiplt"},on:{change:t.getFile}})],2),t.loading?e("div",{staticClass:"loader"},[t._v("图片上传中…")]):t._e(),e("div",{staticClass:"subtitle",staticStyle:{"margin-top":"40px"}},[t._v("示例图片")]),e("img",{staticStyle:{width:"100%"},attrs:{src:"https://cdn.qiandaoapp.com/interior/images/96e6aabaa826a66d5269c5ded0aa21c7.png",alt:"intro"}}),e("div",{class:["fixed-btn",{disable:0===this.imageList.length||this.loading}],on:{click:t.ocr}},[t._v(" 下一步 ")])]):t._e(),2===this.part?e("div",{staticClass:"ocr-result-list"},[t.loading?e("div",{staticClass:"loader"},[t._v(" 智能识别中…（"+t._s(this.ocrSuccessCount)+"/"+t._s(this.imageList.length)+"） ")]):t._e(),t.loading?t._e():e("div",{staticClass:"text-btn",on:{click:function(e){t.part=1}}},[t._v(" ← 重新上传图片 ")]),t.loading?t._e():e("div",{staticStyle:{padding:"0px 15px 15px"}},[t._v(" 状态 "),e("div",{staticClass:"tags-wrap",staticStyle:{display:"inline-block"}},t._l([{id:9,value:"通行品相"},{id:10,value:"有瑕疵"},{id:11,value:" 评级卡"},{id:206,value:"有损伤"}],(function(s,i){return e("div",{key:i,class:["tag",{active:t.selectedZhuangtaiSpec===s.id}]},[e("div",{on:{click:function(e){t.selectedZhuangtaiSpec=s.id}}},[t._v(" "+t._s(s.value)+" ")])])})),0)]),t.loading?t._e():e("div",{staticStyle:{padding:"0px 15px 15px"}},[t._v(" 来源 "),e("div",{staticClass:"tags-wrap",staticStyle:{display:"inline-block"}},t._l([{id:1,value:" 现货"},{id:61460,value:" 抽卡机直发"}],(function(s,i){return e("div",{key:i,class:["tag",{active:t.selectedLaiyuanSpec===s.id}]},[e("div",{on:{click:function(e){t.selectedLaiyuanSpec=s.id}}},[t._v(" "+t._s(s.value)+" ")])])})),0)]),this.ocrResultList.length>0?e("div",{staticClass:"sku-list"},t._l(this.ocrResultList,(function(s,i){return e("div",{key:i,staticClass:"sku"},[e("div",{staticClass:"sku-cover-img"},[e("img",{attrs:{src:s.attachments[0].url+"!lfit_w1080.jpg",alt:"cover"}}),e("div",{staticClass:"delete-btn",on:{click:function(e){return t.deleteSku(i)}}},[e("img",{staticClass:"delete-btn-img",attrs:{src:"https://cdn.qiandaoapp.com/interior/images/dc293fba0d2bb97383dd834fb5226cbb.png",alt:"delete"}}),t._v(" 删除 ")])]),e("div",{staticClass:"info"},[e("div",{staticStyle:{color:"#a1a1a1"}},[t._v(t._s(s.category))]),e("div",{staticStyle:{"font-size":"16px"}},[t._v(" "+t._s(s.name)+" "),e("span",{staticStyle:{"font-size":"12px","margin-left":"5px"}},[t._v(" "+t._s(s.num)+" ")])]),e("div",[t._v(" 价格 "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.price,expression:"item.price"}],staticStyle:{width:"60px","margin-right":"5px"},attrs:{placeholder:"请输入"},domProps:{value:s.price},on:{input:function(e){e.target.composing||t.$set(s,"price",e.target.value)}}}),t._v(" 元 ")]),e("div",[t._v(" 描述 "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.description,expression:"item.description"}],attrs:{placeholder:"请输入"},domProps:{value:s.description},on:{input:function(e){e.target.composing||t.$set(s,"description",e.target.value)}}})])])])})),0):t._e(),e("div",{class:["fixed-btn",{disable:this.loading}],on:{click:t.publish}},[t._v(" 下一步 ")])]):t._e(),3===this.part?e("div",{staticClass:"ocr-result-list"},[t.loading?e("div",{staticClass:"loader"},[t._v(" 发布中...（剩余 "+t._s(this.ocrResultList.length-this.num)+"） ")]):t._e(),t.success?e("div",{staticClass:"tip"},[e("div",{staticStyle:{"font-size":"30px","margin-bottom":"10px"}},[t._v("✅")]),e("div",{staticStyle:{"margin-bottom":"50px"}},[t._v("发布成功")]),e("div",[e("div",{staticClass:"main-btn solid",on:{click:t.goToMine}},[t._v("去查看")]),e("div",{staticClass:"main-btn line",on:{click:t.goToFollowTip}},[t._v(" 关注公众号/下载 App ")]),e("div",{staticStyle:{color:"#999","font-size":"12px","margin-top":"5px"}},[t._v(" 不错过下单、咨询信息 ")])])]):t._e()]):t._e()])},r=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"subtitle",staticStyle:{"margin-bottom":"20px"}},[t._v(" 上传图片 "),e("div",{staticClass:"intro"},[t._v("可批量上传多图")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"upload-btn",attrs:{for:"upload"}},[e("span",{staticClass:"circle"},[t._v("+")]),e("br"),t._v(" 点击上传 ")])}],a=(s("14d9"),s("7cb2")),n=s("ed08"),c=s("2f62"),o=s("dd8a"),u=s("a849"),l=s("ccbb"),p={data(){return{loading:!1,part:1,imageList:[],ocrResultList:[],ocrSuccessCount:0,isOpenModal:!1,selectedIndex:0,spuList:[],query:"",image:"",num:0,success:!1,selectedZhuangtaiSpec:9,selectedLaiyuanSpec:1}},computed:{...Object(c["mapState"])("user",["me"]),isWxMp(){return Object(n["h"])()},isApp(){return Object(n["d"])()}},mounted(){"{}"===JSON.stringify(this.me)&&this.logIn()},methods:{async getFile(t){const e=t.target.files;for(var s=0;s<e.length;s++){this.loading=!0;var i=e[s].name,r=i.lastIndexOf(".");if(-1!==r){var c=i.substr(r+1).toUpperCase();c=c.toLowerCase();const t=Object(n["i"])(),o=new File([e[s]],t+".jpeg"),u=await Object(a["b"])(o,"activity-temp.image");this.imageList.push(u.url)}}this.loading=!1},deleteImage(t){this.imageList.splice(t,1)},deleteSku(t){this.ocrResultList.splice(t,1),this.$toast.show({title:"已删除"}),0===this.ocrResultList.length&&(this.part=1)},async ocr(){this.part=2,this.ocrResultList=[],this.ocrSuccessCount=0;for(var t=0;t<this.imageList.length;t++){this.loading=!0;try{const a=await o["a"].ocr({url:this.imageList[t]+"!lfit_w1080.jpg",ocrType:"ALIYUN",level:"HD"});var e=a.data.prismWordsInfo;const n=await o["a"].ocr({url:this.imageList[t]+"!rotate_270",ocrType:"ALIYUN",level:"HD"});e=e.concat(n.data.prismWordsInfo);for(var s=!1,i=0;i<e.length;i++)if(-1!==e[i].word.indexOf("-")){const a={q:e[i].word,"start-index":0,"max-results":1,tagIds:"1422849",scene:"plugin-mlp-publish"};try{const e=await l["a"].searchSpuInTag(a);e.data.items.length>0&&!s&&(this.ocrResultList.push({attachments:[{url:this.imageList[t],type:"image"}],spuId:e.data.items[0].id,price:null,category:e.data.items[0].category_name,name:e.data.items[0].name,num:e.data.items[0].description,description:""}),s=!0)}catch(r){console.error(r)}}this.ocrSuccessCount++}catch(r){console.error(r)}}0===this.ocrResultList.length&&(this.part=1,this.$toast.show({title:"未识别到款式"})),this.loading=!1},handleMaskClick(){this.isOpenModal=!1,this.query=""},backToPreview(){this.part=2},logIn(){const t="/modules/pages/common-login/index";Object(n["h"])()||Object(n["d"])()?this.navigateTo({url:t}):window.location.href="https://m.qiandaoapp.com/assist/#/login?redirectUrl=https%3A%2F%2Fm.qiandaoapp.com%2Fplugin%2Fmlp-publish"},goToMine(){const t="/pages-me/users/product-on-sale";(Object(n["h"])()||Object(n["d"])())&&this.navigateTo({url:t})},goToFollowTip(){const t="/modules/pages/web-view/index?url=https://mp.weixin.qq.com/s/Z761HNZUlfu23SOQhuhsEA";(Object(n["h"])()||Object(n["d"])())&&this.navigateTo({url:t})},async publish(){this.success=!1,this.part=3,this.loading=!0,this.num=0;for(var t=0;t<this.ocrResultList.length;t++){this.num++;const s={attachments:this.ocrResultList[t].attachments,price:Number(this.ocrResultList[t].price),remark:this.ocrResultList[t].description,specValueIds:[this.selectedZhuangtaiSpec,this.selectedLaiyuanSpec],spuId:this.ocrResultList[t].spuId,status:"ON_SALE",stock:1,type_id:1405184};try{await u["a"].productPublish(s)}catch(e){console.error(e),this.ocrResultList.splice(t-1,t),this.part=2}}this.success=!0,this.loading=!1}}},g=p,d=(s("d4f2"),s("0c7c")),h=Object(d["a"])(g,i,r,!1,null,null,null);e["default"]=h.exports},a849:function(t,e,s){"use strict";var i=s("0ef7"),r=s("4360");e["a"]={getSingleBanner(t){return i["p"].get("/ads",{slotKey:t,appid:r["a"].state.app.puppet.name})},queryDeliverOrderPrice(t){return i["h"].post("/order/action/query-deliver-order-price",t)},getSellingProducts(t){return i["h"].get("trade/user/products/action/get-selling-products",t)},doGrayscale(t){return i["h"].get("/stock-order/grayscale",t)},queryShelfExpressRule(t){return i["h"].post("/express/user/express-price-template/action/load-by-shelf",t)},queryProductsMatch(t){return i["p"].get("/products/match",t)},queryProductsByTag(t){return i["h"].post("/stock-order/bargin",t)},productPublish(t){return i["h"].post("/trade/products",t)},getAuctionField(t){return i["h"].get("/auctioneer/field/list",t)},auctionPublish(t){return i["h"].post("/c2c-web/v1/auctioneer/auction/create",t)},getTags(t){return i["h"].get("/trade/tags",t)}}},ccbb:function(t,e,s){"use strict";var i=s("0ef7");e["a"]={getStandardProducts(t){return i["p"].get(`/spus/${t}/standard-products`)},getSPUs(t){return i["p"].get("/v2/spus",t)},getSingleSpu(t,e){return i["p"].get("/v2/spus/"+t,e)},getUserPosters(t){return i["h"].post("/c2c-web/v1/poster/get-user-posters",t)},doProductsOffSale(t){return i["h"].post("/c2c-web/v1/c2c/products/off-sale",t)},plastSearchCategory(t){return i["h"].get("/plast/search/category/v3",t)},createUserPoster(t){return i["h"].post("/c2c-web/v1/poster/create-user-poster",t)},getSPUSpecs(t){return i["p"].get(`/spus/${t}/specs`)},updateC2cProductsByCategory(t){return i["h"].post("/c2c/products/m-update",t)},updateProductMulti(t){return i["h"].post("/c2c/products/multi-create",t)},createProductMulti(t){return i["h"].post("/c2c/products/m-create-update",t)},getProductsByCategory(t){return i["h"].get("/c2c/products/by-category",t)},getCategoryDetail(t,e){return i["p"].get("/v2/categories/"+t,e)},getCategories(t){return i["p"].get("/v2/categories",t)},getRecommendCategories(t){return i["p"].get(`/v2/categories/${t}/recommend`)},getCategoryTags(t){return i["p"].get(`/v2/categories/${t}/config`)},getTag(t,e){return i["p"].get("/tags/"+t,e)},getHotTags(t){return i["p"].get(`/tags/${t}/config`)},getTags(t){return i["p"].get("/tags",t)},searchCategories(t){return i["p"].get("/v2/categories",t)},getSettings(){return i["p"].get("/settings")},changeWishes(t){return i["p"].post("/wish-list",t)},updateUserSettings(t){return i["p"].put("/settings",t)},getPosterColumnConfig(t){return i["l"].get("/action/get-products-poster",t)},getPosterThemes(t){return i["l"].get("/action/get-poster-themes",t,{isErrorDefaultTip:!1})},getWishList(t){return i["p"].get("/wish-list",t,{isErrorDefaultTip:!1})},getWishMatches(t){return i["p"].get("/products/match/wish-list",t,{isErrorDefaultTip:!1})},getDemandProductList(t){return i["p"].get("/products/match/demand-list",t)},getTradeInfo(t){return i["p"].post("/action/get-trade-info",t)},get360DegImages(t){return i["p"].get(`/spus/${t}/360-degree-images`)},getBarginSpus(t){return i["p"].post("/stock-order/bargin",t)},getSpecsByMPName(t){return i["p"].get("/specs/aciton/get-by-app-name",t)},getDistribution(t){return i["p"].get("/feeds/chaowan",t)},getSellingCategories(t){return i["p"].get("/products/action/get-selling-categories",t)},getCategoryCount(t){return i["p"].get("/products/action/get-category-product-count",t)},getSpuList(t){return i["h"].post("/treasure/spus/search/simple-info",t)},getSpuHeader(t){return i["h"].get("/treasure/flora/v2/spu/simpleInfo",t)},getSpuDetails(t){return i["h"].get("/treasure/flora/v1/spu/detailInfo",t)},getTagList(t){return i["h"].get("/treasure/tags",t)},getTagDetails(t){return i["h"].get("/treasure/flora/v1/tag/detailInfo",t)},getTagDetailsV2(t){return i["h"].get("/treasure/flora/v2/tag/simpleInfo",t)},searchSpuInTag(t){return i["h"].get("/plast/search/spu",t)},searchTag(t){return i["h"].get("/plast/search/tag",t)},getXiaokaWebConfig(){return i["e"].get("/vinyl/web.json")},getTagsV2(t){return i["h"].get("/armory/entry/tags",t)}}},d4f2:function(t,e,s){"use strict";s("5f77")},dd8a:function(t,e,s){"use strict";var i=s("0ef7");e["a"]={myPokemon(t){return i["q"].get("/v1/pokemon/my",t)},nextStep(t){return i["q"].post("/v1/pokemon/next-step",t)},searchSpuByImage(t){return i["q"].post("/v1/image/search/spu",t)},searchSpuByAggregateImages(t){return i["q"].post("/v1/image/search/multi/spu/v2",t)},ocr(t){return i["j"].post("/z/stargazing/z/ocr",t)},getQrcode(t){return i["j"].get("/z/poster-web/wechat/mp-qrcode",t)},getSpuOpposite(t){return i["j"].post("/treasure/spus/opposite/list",t)},getSpuWithRelated(t){return i["j"].post("/treasure/v1/search/spu/with/related",t)},getSpuWaterfall(t){return i["j"].get("/treasure/v1/waterfall/list",t)},fetchStep2BizConfig(){return i["j"].get("https://config-cdn.qiandaoapp.com/mp-common/pluginsBizConfig.json")},getRankInfo(t){return i["j"].get("/treasure/flora/v1/rank",t)},getByDistributedTagIds(t){return i["j"].post("/treasure/v1/public-relations/byDistributedTagIds",t)},getPalworld(t){return i["g"].get("/palu/check",t)}}}}]);